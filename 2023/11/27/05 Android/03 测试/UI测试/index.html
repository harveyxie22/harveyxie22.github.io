<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	
	<!-- title -->
	
	<title>
	
		UI 测试 | 
	 
	Harvey&#39;s Notes
	</title>
	
	<!-- keywords,description -->
	
	

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/favicon.ico">
	


	<!-- search -->
	<script>
		var searchEngine = "https://www.google.com/search?q=";
		if(typeof searchEngine == "undefined" || searchEngine == null || searchEngine == ""){
			searchEngine = "https://www.google.com/search?q=";
		}
		var homeHost = "";
		if(typeof homeHost == "undefined" || homeHost == null || homeHost == ""){
			homeHost = window.location.host;
		}
	</script>


	
<link rel="stylesheet" href="/css/main.css">

	
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/darcula.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">


	
<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

	
<script src="/js/main.js"></script>


	
	

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.0.0"><link rel="stylesheet" href="/css/prism-dark.css" type="text/css"></head>

<body>
	<header id="header">
    <a id="title" href="/" class="logo">Harvey's Notes</a>

	<ul id="menu">
    
      <li class="menu-item">
        <a href="/about" class="menu-item-link">About</a>
      </li>
    

    

    

    
  
    
      <li class="menu-item">
        <a href='https://harveyxie22.github.io' class="menu-item-link" target="_blank">
          <i class="fa fa-github fa-2x"></i>
        </a>
      </li>
    
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="search" placeholder="Press Enter to search">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										01 计算机基础
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/26/01%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/01%20%E8%BF%9B%E5%88%B6%E6%95%B0%E5%92%8C%E5%AD%98%E5%82%A8%E5%8D%95%E4%BD%8D/">
                     
										    01 进制数和存储单位
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/26/01%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/02%20ASCII%20%E7%A0%81%E8%A1%A8/">
                     
										    02 ASCII 码表
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/26/01%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/03%20%E5%BC%80%E6%BA%90%E5%8D%8F%E8%AE%AE/">
                     
										    03 开源协议
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										02 C
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/26/02%20C/01%20%E5%85%A5%E9%97%A8%E4%BB%8B%E7%BB%8D/">
                     
										    01 入门介绍
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/26/02%20C/02%20%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E4%B8%8E%E8%BF%90%E7%AE%97%E7%AC%A6/">
                     
										    02 数据类型与运算符
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/10/02%20C/03%20%E6%95%B0%E7%BB%84/">
                     
										    03 数组
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/10/02%20C/04%20%E6%8C%87%E9%92%88/">
                     
										    04 指针
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/10/02%20C/05%20%E5%AE%8F%E5%AE%9A%E4%B9%89%E4%B8%8E%E5%B8%B8%E9%87%8F/">
                     
										    05 宏定义与常量
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/10/02%20C/06%20%E5%87%BD%E6%95%B0/">
                     
										    06 函数
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/10/02%20C/07%20%E5%AD%97%E7%AC%A6%E4%B8%B2/">
                     
										    07 字符串
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/19/02%20C/08%20%E7%BB%93%E6%9E%84%E4%BD%93/">
                     
										    08 结构体
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/16/02%20C/09%20%E6%96%87%E4%BB%B6/">
                     
										    09 文件
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/16/02%20C/10%20%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%86%85%E5%AD%98%E5%9B%9B%E5%8C%BA/">
                     
										    10 编译过程与内存四区
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/17/02%20C/20%20C%20%E8%AF%AD%E8%A8%80%E7%BB%8F%E5%85%B8100%E4%BE%8B/">
                     
										    20 C 语言经典100例
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										03 C++
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/25/03%20C++/hello-world/">
                     
										    hello-world
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										04 Java
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										01 高级进阶
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/25/04%20Java/01%20%E9%AB%98%E7%BA%A7%E8%BF%9B%E9%98%B6/01%20%E5%8F%8D%E5%B0%84/">
                     
										    01 反射
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/25/04%20Java/01%20%E9%AB%98%E7%BA%A7%E8%BF%9B%E9%98%B6/02%20%E6%B3%A8%E8%A7%A3/">
                     
										    02 注解
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/25/04%20Java/01%20%E9%AB%98%E7%BA%A7%E8%BF%9B%E9%98%B6/03%20%E6%B3%9B%E5%9E%8B/">
                     
										    03 泛型
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/26/04%20Java/01%20%E9%AB%98%E7%BA%A7%E8%BF%9B%E9%98%B6/04%20%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">
                     
										    04 序列化和反序列化
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/26/04%20Java/01%20%E9%AB%98%E7%BA%A7%E8%BF%9B%E9%98%B6/05%20%E7%BA%BF%E7%A8%8B/">
                     
										    05 线程
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										02 设计模式
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/12/09/04%20Java/02%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/01%20%E5%BC%95%E8%A8%80/">
                     
										    01 引言
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/09/04%20Java/02%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/02%20%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/">
                     
										    02 工厂模式
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/09/04%20Java/02%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/03%20%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/">
                     
										    03 单例模式
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										05 Android
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										01 Framework
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/12/02/05%20Android/01%20Framework/01%20%E4%B8%8B%E8%BD%BD%20AOSP%20%E6%BA%90%E7%A0%81/">
                     
										    01 下载 AOSP 源码
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/02/05%20Android/01%20Framework/02%20Android%E7%89%88%E6%9C%AC%E5%8F%B7/">
                     
										    02 Android版本号
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										02 性能调优
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										01 基础命令
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/12/17/05%20Android/02%20%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/01%20%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/01%20%E8%BF%9B%E5%85%A5%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/">
                     
										    01 进入工厂模式
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/17/05%20Android/02%20%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/01%20%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/02%20%E8%AE%BE%E5%A4%87%E4%BF%A1%E6%81%AF/">
                     
										    02 设备信息
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										02 工具
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/25/05%20Android/02%20%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/02%20%E5%B7%A5%E5%85%B7/01%20Systrace/">
                     
										    01 Systrace
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/25/05%20Android/02%20%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/02%20%E5%B7%A5%E5%85%B7/02%20Simpleperf/">
                     
										    02 Simpleperf
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										03 测试
									</a>
									
							<ul>
								<li class="file active">
									<a href="/2023/11/27/05%20Android/03%20%E6%B5%8B%E8%AF%95/UI%E6%B5%8B%E8%AF%95/">
                     
										    UI测试
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										06 Linux
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										01 Ubuntu 基础使用
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/25/06%20Linux/01%20Ubuntu%20%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E5%88%9B%E5%BB%BA%E5%BA%94%E7%94%A8%E6%A1%8C%E9%9D%A2%E5%9B%BE%E6%A0%87/">
                     
										    创建应用桌面图标
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/02/06%20Linux/01%20Ubuntu%20%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E5%90%AF%E5%8A%A8Springboot%E5%B7%A5%E7%A8%8B/">
                     
										    启动Springboot工程
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/02/06%20Linux/01%20Ubuntu%20%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E5%AE%89%E8%A3%85ADB%E3%80%81AAPT%E3%80%81JAVA/">
                     
										    安装ADB、AAPT、JAVA
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/25/06%20Linux/01%20Ubuntu%20%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/%E6%9B%B4%E6%96%B0%E8%BD%AF%E4%BB%B6%E6%BA%90/">
                     
										    更新软件源
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										09 Hexo
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/27/09%20Hexo/01%20Typora+Hexo%E5%9B%BE%E7%89%87%E5%A4%84%E7%90%86%E5%8A%9E%E6%B3%95/">
                     
										    01 Typora+Hexo图片处理办法
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/11/27/09%20Hexo/02%20%E8%AE%A9%20Hexo%20%E6%94%AF%E6%8C%81%20LaTeX%20%E5%85%AC%E5%BC%8F/">
                     
										    02 让 Hexo 支持 LaTeX 公式
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										11 工具
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/01/07/11%20%E5%B7%A5%E5%85%B7/01%20Postman/">
                     
										    01 Postman
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										12 读书笔记
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/25/12%20%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E4%B8%BA%E4%BB%80%E4%B9%88%E7%B2%BE%E8%8B%B1%E9%83%BD%E6%98%AF%E6%97%B6%E9%97%B4%E6%8E%A7/">
                     
										    为什么精英都是时间控
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
		</div>
	</div>
</div>

	<!-- 引入正文 -->
	<div id="content" class="content">
		<h1 id="article-title">
	UI 测试
</h1>

<!-- meta -->
<div class="article-meta">
	

	<span>Harvey Xie</span>
	<span>2023-11-27 21:02:34</span>

  <div id="article-categories">
    
		  <span>Categories：</span>
      
          
              <span>
                  <i class="fa fa-folder" aria-hidden="true">
                  <a href="/categories/Android/">Android</a>
                  </i>
                
              </span>
          
      
    

    
		    <span>Tags：</span>
        
            
                <span>
                    <i class="fa fa-tag" aria-hidden="true">
                    <a href="/tags/UI-测试/">UI 测试</a>
                    </i>
                </span>
            
        
            
                <span>
                    <i class="fa fa-tag" aria-hidden="true">
                    <a href="/tags/UI-Automator/">UI Automator</a>
                    </i>
                </span>
            
        
    
  </div>

</div>

<!-- content -->
<div id="article-content">
	<p>UI Automator 测试框架提供了一组 API，用于构建在用户应用和系统应用上执行交互的界面测试。通过 UI Automator API，您可以执行在测试设备中打开「设置」菜单或应用启动器等操作。UI Automator 测试框架非常适合编写黑盒式自动化测试，此类测试的测试代码不依赖于目标应用的内部实现细节。</p>
<p>什么叫构建在用户应用和系统应用上执行交互的界面测试，可以执行在测试设备中开「设置」菜单或应用启动器等操作？其实指的就是通过 UI Automator 模仿人类的点击操作，完成硬编码无法完成的事情。例如有的应用在开启前希望能够自动的连接 Wi-Fi，在低版本上可以通过反射的方式实现，但是到了高版本就不能够通过反射实现了。此时，就可以通过 UI Automator 模仿人工操作的点击界面的方式进行开启和关闭网络。</p>
<p>UI Automator 测试框架的主要功能包括：</p>
<ul>
<li>
<p>用于检查布局层次结构的查看器</p>
<p>因为 UI Automator 属于黑盒测试，所以它提供了一个用于扫描和分析 Android 设备上当前显示的界面组件的层次关系工具 <code>uiautomatorviewer</code>。这个工具在 <code>&lt;android-sdk&gt;/tools/bin </code>中。</p>
</li>
<li>
<p>用于检索状态信息并在目标设备上执行操作的 API</p>
<p>在 UI Automator 中关于目标设备（指的就是你连接电脑的手机）的操作被封装了一个 <code>UiDevice </code> 对象。通过在代码中创建该对象的实例来操作设备。例如：改变设备的旋转、模仿按键输入、返回主界面、打开通知栏、当前窗口截图等等。</p>
</li>
<li>
<p>支持跨应用界面测试的 API</p>
<p>在应用间进行操作界面元素的时候，界面的组件被划分成了一些控件：</p>
<ul>
<li><code>UiCollection</code>：枚举容器的界面元素，目的是为了计数，或者按可见文本或内容说明属性来定位子元素。</li>
<li><code>UiObject</code>：表示设备上可见的界面元素。</li>
<li><code>UiScrollable</code>：支持搜索可滚动界面容器中的项目。</li>
<li><code>UiSelector</code>：表示对设备上的一个或多个目标界面元素的查询。</li>
<li><code>Configurator</code>：可让您设置用于运行 UI Automator 测试的关键参数。</li>
</ul>
<p>例如，常见的可滑动的组件 List View、Recycle View 等被封装成了 <code>UiScrollable</code> 对象，通过选择器先获取界面元素，然后滑动获取界面元素，从而完成诸如点击、拖动、输入等操作。</p>
</li>
</ul>
<p>所以，熟练地掌握使用 UI Automator 是开发者和测试人员必备的技能之一。</p>
<h1 id="ui-元素查看器"><a class="markdownIt-Anchor" href="#ui-元素查看器"></a> UI 元素查看器</h1>
<p>UI Automator 的查看器在 <code>&lt;android-sdk&gt;/tools/bin </code> 中，名字叫 <code>uiautomatorviewer.bat</code>。如果不知道电脑 Android SDK 的路径在哪里，可以尝试如下两种方式：</p>
<ol>
<li>
<p>Android Studio</p>
<p>打开 Android Studio，然后依次 File &gt; Project Structure &gt; SDK Location，即可查看到当前 SDK 的位置。</p>
</li>
<li>
<p>下载 Everything，全局搜索</p>
<p><a target="_blank" rel="noopener" href="https://www.voidtools.com/zh-cn/">Everything</a> 是一款第三方的电脑搜索神器，用于快速检索电脑中的文件。下载后，在搜索栏中输入 <code>uiautomatorviewer</code> 即可快速定位到文件的位置。找到  <code>uiautomatorviewer.bat</code> 文件后，点击打开即可看到如下的界面：</p>
<p><img src="/images/uiautomator_1.png" alt="uiautomatorviewer" /></p>
<p>若点击的时候，无反应或者出现的黑窗口一闪而过的话，可能是因为 Java 的版本不匹配。查看本机的 Java 版本可以使用  <code>win + R</code> &gt; <code>cmd</code>  &gt; <code>Java -version</code> 命令。若 Java 的版本不是 1.8 的话，可以尝试重新安装 Java 1.8 版本。</p>
</li>
</ol>
<p>UI 元素查看器的界面如下图所示：</p>
<p><img src="/images/uiautomator_2.png" alt="uiautomatorviewer" /></p>
<p>界面被划分成了四个部分：</p>
<ol>
<li>
<p>菜单栏区域 ( 数字 1)</p>
<p>菜单栏只有四个按钮，依次是：打开本地保存的布局、获取设备的界面布局、获取简洁的界面布局和保存布局。</p>
<ul>
<li>
<p>保存布局</p>
<p>点击后，会保存成两个文件：图片文件和 <code>.uix</code> 文件 ( XML 结构 )。</p>
</li>
<li>
<p>第二个按钮和第三个按钮的区别</p>
<p>点击第二个按钮会把全部的布局呈现出现，而点击第三个按钮后会省略掉很多诸如 <code>FrameLayout</code> 等容器的布局，直接呈现界面上的主要的界面元素。</p>
</li>
</ul>
</li>
<li>
<p>界面布局区域 ( 数字 2 )</p>
<p>当电脑连接了手机或者打开了一个模拟器后，点击菜单栏中的第二个或者第三个按钮就可以获取到当前设备显示的界面布局结构。若手机处于黑屏状态，则获取到的界面就是黑屏布局。</p>
<p>当鼠标处于该区域的时候，可以选择任意一个布局。选中后的布局就会呈现红色方框。</p>
</li>
<li>
<p>界面层次区域 ( 数字 3 )</p>
<p>当前界面的层次会被以树形的结构显示到该区域中。当在界面布局区域选中后，该区域会同步标记具体的所在层级和节点。</p>
</li>
<li>
<p>布局信息区域 ( 数字 4 )</p>
<p>该区域会显示选择布局的具体信息，例如索引、文本、资源 ID、类名、包名等。该信息是 UI Automator 自动化的基础，用于框架选择界面上的具体元素，从而操作它们。</p>
</li>
</ol>
<h1 id="创建项目"><a class="markdownIt-Anchor" href="#创建项目"></a> 创建项目</h1>
<p>为了让大家快速入门 UI Automator 框架，我们使用 Android Studio 创建一个项目来感受一下 UI Automator 的魅力。首先，打开你的 Android Studio 选择创建一个 Login Activity 简单的实例，语言选择使用 Java 而不是 Kotlin。</p>
<p>使用模拟器运行这个项目，可以看到设备显示的界面很简单，就是一个类似登录的功能，由邮箱、密码和点击按钮组成。在项目的左边，Android Studio 自动生成了一些目录结构，其中有一个叫做 <code>androidTest</code> 目录。该目录就是用于编写 UI 界面测试的目录。</p>
<p><img src="/images/uiautomator_3.png" alt="Android Test" /></p>
<h2 id="开始编写测试"><a class="markdownIt-Anchor" href="#开始编写测试"></a> 开始编写测试</h2>
<p>现在，我们使用 UI Automator 来模拟人工的输入邮箱、密码，最后点击按钮的操作。首先，在 <code>androidTest</code> 目录下创建一个 Java 文件 <code>LoginTest.java</code> 。同时，给该类添加一个注解 <code>@RunWith(AndroidJUnit4.class)</code> ，该注解是 JUnit 提供的，具体参看 <a target="_blank" rel="noopener" href="http://junit.org/junit4/">文档</a> 。</p>
<pre class="highlight"><code class="java"><span class="hljs-meta">@RunWith(AndroidJUnit4.class)</span>
<span class="hljs-meta">@SdkSuppress(minSdkVersion = 18)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoginTest</span> &#123;

    <span class="hljs-meta">@BeforeClass</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUp</span><span class="hljs-params">()</span> &#123;
      
    &#125;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testLoginFlow</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> UiObjectNotFoundException &#123;
     
    &#125;

&#125;

</code></pre>
<p>然后，在 <code>build.gradle(Module)</code> 中添加 <code>uiautomator</code> 的依赖。根据项目的实际情况，可能会选择使用其他的版本，可以通过 <a target="_blank" rel="noopener" href="https://mvnrepository.com/artifact/com.android.support.test.uiautomator/uiautomator-v18">Maven</a> 仓库查看一些常见的版本。</p>
<pre class="highlight"><code class="java">androidTestImplementation <span class="hljs-string">&#x27;com.android.support.test.uiautomator:uiautomator-v18:2.1.3&#x27;</span>
</code></pre>
<p>通过之前的查看器，先获取到该布局的一些信息。可以看到 <code>Email</code> 的输入框中的 <code>resouce-id</code> 是 <code>com.example.myuiautomator:id/username</code> 。同理，<code>Password</code> 的  <code>resouce-id</code>  是 <code>com.example.myuiautomator:id/password</code>，按钮的 <code>resouce-id</code>  是 <code>com.example.myuiautomator:id/login</code> 。</p>
<p><img src="/images/uiautomator_4.png" alt="Android Test" /></p>
<p>最后，编写 UI 界面的测试。</p>
<pre class="highlight"><code class="java"><span class="hljs-meta">@RunWith(AndroidJUnit4.class)</span>
<span class="hljs-meta">@SdkSuppress(minSdkVersion = 18)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoginTest</span> &#123;

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> UiDevice uiDevice;

    <span class="hljs-meta">@BeforeClass</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUp</span><span class="hljs-params">()</span> &#123;
        <span class="hljs-comment">// 先获取到终端设备</span>
        uiDevice = UiDevice.getInstance(InstrumentationRegistry.getInstrumentation());

        <span class="hljs-comment">// 开启你的应用</span>
        <span class="hljs-type">Context</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> getApplicationContext();
        <span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> context.getPackageManager().getLaunchIntentForPackage(<span class="hljs-string">&quot;com.example.myuiautomator&quot;</span>);
        intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK);
        context.startActivity(intent);
    &#125;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testLoginFlow</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> UiObjectNotFoundException &#123;
        <span class="hljs-comment">// 通过资源 ID 找到 Email 控件，然后给它设置邮箱</span>
        <span class="hljs-type">UiObject</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> uiDevice.findObject(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UiSelector</span>().resourceId(<span class="hljs-string">&quot;com.example.myuiautomator:id/username&quot;</span>));
        username.setText(<span class="hljs-string">&quot;wyblogs@outlook.com&quot;</span>);

        <span class="hljs-comment">// 通过资源 ID 找到 password 控件，然后给它设置密码</span>
        <span class="hljs-type">UiObject</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> uiDevice.findObject(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UiSelector</span>().resourceId(<span class="hljs-string">&quot;com.example.myuiautomator:id/password&quot;</span>));
        password.setText(<span class="hljs-string">&quot;12345678&quot;</span>);
        
		<span class="hljs-comment">// 最后点击按钮，完成操作</span>
        <span class="hljs-type">UiObject</span> <span class="hljs-variable">button</span> <span class="hljs-operator">=</span> uiDevice.findObject(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UiSelector</span>().resourceId(<span class="hljs-string">&quot;com.example.myuiautomator:id/login&quot;</span>));
        password.click();
    &#125;

&#125;
</code></pre>
<p>在测试开始前，需要先手动开启应用，否则会出现控件无法获取到，或者会出现应用闪退的情况。编写完测试用例后，点击代码左边的绿色三角形就可以把测试用例跑起来了。</p>

</div>

<!-- post-guide -->

    <div class="post-guide">
        <div class="item left">
            
              <a href="/2023/11/27/09%20Hexo/02%20%E8%AE%A9%20Hexo%20%E6%94%AF%E6%8C%81%20LaTeX%20%E5%85%AC%E5%BC%8F/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  让 Hexo 支持 LaTeX 公式
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/2023/11/26/01%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/01%20%E8%BF%9B%E5%88%B6%E6%95%B0%E5%92%8C%E5%AD%98%E5%82%A8%E5%8D%95%E4%BD%8D/">
                进制数、存储单位
                <i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>


<!-- comment - giscus -->



	
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
          }
        });
        MathJax.Hub.Queue(function() {
          var all = MathJax.Hub.getAllJax(), i;
          for(i=0; i < all.length; i += 1) {
              all[i].SourceElement().parentNode.className += ' has-jax';
          }
        });
    </script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2.7.8/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>



<!-- comment - valine -->


<script>
	
	
</script>
	</div>
	<div id="footer">
	<p>
	©<span id="footerYear-start"></span>-<span id="footerYear-end"></span>

	
	    <a href="/">Harvey Xie</a>
	
	
	
	<br>
	Theme <a href="//github.com/wujun234/hexo-theme-tree" target="_blank">Tree</a>
<!-- 	by <a href="//wujun.me" target="_blank">Wu Jun</a> -->
	Powered by <a href="//hexo.io" target="_blank">Hexo</a>
	</p>
</div>


<script type="text/javascript">
	document.getElementById('footerYear-start').innerHTML = new Date().getFullYear() + '';
</script>

<script type="text/javascript">
	document.getElementById('footerYear-end').innerHTML = new Date().getFullYear() + '';
</script>

	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>